define tumbling window by_two
with
  size = 2
end;

define tumbling window by_four
with
  size = 4
end;

mod m with
    aggregate collect_joined of
        init() =>
            []

        aggregate(st, x) =>
            st + [x]

        mergein(st, x) =>
            st + x

        emit(st) =>
            st
    end
end;

select aggr::win::collect_flattened(event) from in[by_two, by_four] group by event into out;

use std::string;

define tumbling window my_window
with
  interval = core::datetime::with_seconds(1),
  emit_empty_windows = true
end;
define tumbling window my_other_window
with
  interval = core::datetime::with_seconds(3),
  emit_empty_windows = true
end;

select
  [
    window,
    aggr::stats::count(),
    string::uppercase(event.name),
    not not event.bool,
    aggr::win::last(event.array),
    aggr::win::collect_flattened($)
  ]
from in[my_window, my_other_window]
group by set(event.name, not event.bool)
into out;